module.exports=[26794,e=>{"use strict";let t,s,r;var n,a,i,o,l,c,u,h,d,p,f,m,g,y,w,b,v,_,k,S,x,R,M,A,P,E,T,$,O,I,N,j,q,C,U,L,W,H,D,F,X,B,K,J,V,z,G,Q,Y,Z,ee,et,es,er,en,ea,ei,eo,el,ec,eu,eh,ed,ep=e.i(47909),ef=e.i(74017),em=e.i(96250),eg=e.i(59756),ey=e.i(61916),ew=e.i(14444),eb=e.i(37092),ev=e.i(69741),e_=e.i(16795),ek=e.i(87718),eS=e.i(95169),ex=e.i(47587),eR=e.i(66012),eM=e.i(70101),eA=e.i(26937),eP=e.i(10372),eE=e.i(93695);e.i(52474);var eT=e.i(220),e$=e.i(89171);function eO(e,t,s,r,n){if("m"===r)throw TypeError("Private method is not writable");if("a"===r&&!n)throw TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!n:!t.has(e))throw TypeError("Cannot write private member to an object whose class did not declare it");return"a"===r?n.call(e,s):n?n.value=s:t.set(e,s),s}function eI(e,t,s,r){if("a"===s&&!r)throw TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!r:!t.has(e))throw TypeError("Cannot read private member from an object whose class did not declare it");return"m"===s?r:"a"===s?r.call(e):r?r.value:t.get(e)}let eN=function(){let{crypto:e}=globalThis;if(e?.randomUUID)return eN=e.randomUUID.bind(e),e.randomUUID();let t=new Uint8Array(1),s=e?()=>e.getRandomValues(t)[0]:()=>255*Math.random()&255;return"10000000-1000-4000-8000-100000000000".replace(/[018]/g,e=>(e^s()&15>>e/4).toString(16))};function ej(e){return"object"==typeof e&&null!==e&&("name"in e&&"AbortError"===e.name||"message"in e&&String(e.message).includes("FetchRequestCanceledException"))}let eq=e=>{if(e instanceof Error)return e;if("object"==typeof e&&null!==e){try{if("[object Error]"===Object.prototype.toString.call(e)){let t=Error(e.message,e.cause?{cause:e.cause}:{});return e.stack&&(t.stack=e.stack),e.cause&&!t.cause&&(t.cause=e.cause),e.name&&(t.name=e.name),t}}catch{}try{return Error(JSON.stringify(e))}catch{}}return Error(e)};class eC extends Error{}class eU extends eC{constructor(e,t,s,r){super(`${eU.makeMessage(e,t,s)}`),this.status=e,this.headers=r,this.requestID=r?.get("request-id"),this.error=t}static makeMessage(e,t,s){let r=t?.message?"string"==typeof t.message?t.message:JSON.stringify(t.message):t?JSON.stringify(t):s;return e&&r?`${e} ${r}`:e?`${e} status code (no body)`:r||"(no status code or body)"}static generate(e,t,s,r){return e&&r?400===e?new eD(e,t,s,r):401===e?new eF(e,t,s,r):403===e?new eX(e,t,s,r):404===e?new eB(e,t,s,r):409===e?new eK(e,t,s,r):422===e?new eJ(e,t,s,r):429===e?new eV(e,t,s,r):e>=500?new ez(e,t,s,r):new eU(e,t,s,r):new eW({message:s,cause:eq(t)})}}class eL extends eU{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class eW extends eU{constructor({message:e,cause:t}){super(void 0,void 0,e||"Connection error.",void 0),t&&(this.cause=t)}}class eH extends eW{constructor({message:e}={}){super({message:e??"Request timed out."})}}class eD extends eU{}class eF extends eU{}class eX extends eU{}class eB extends eU{}class eK extends eU{}class eJ extends eU{}class eV extends eU{}class ez extends eU{}let eG=/^[a-z][a-z0-9+.-]*:/i,eQ=e=>(eQ=Array.isArray)(e),eY=eQ;function eZ(e){return"object"!=typeof e?{}:e??{}}let e0=e=>{try{return JSON.parse(e)}catch(e){return}},e1="0.68.0",e2=e=>"x32"===e?"x32":"x86_64"===e||"x64"===e?"x64":"arm"===e?"arm":"aarch64"===e||"arm64"===e?"arm64":e?`other:${e}`:"unknown",e4=e=>(e=e.toLowerCase()).includes("ios")?"iOS":"android"===e?"Android":"darwin"===e?"MacOS":"win32"===e?"Windows":"freebsd"===e?"FreeBSD":"openbsd"===e?"OpenBSD":"linux"===e?"Linux":e?`Other:${e}`:"Unknown";function e5(...e){let t=globalThis.ReadableStream;if(void 0===t)throw Error("`ReadableStream` is not defined as a global; You will need to polyfill it, `globalThis.ReadableStream = ReadableStream`");return new t(...e)}function e6(e){let t=Symbol.asyncIterator in e?e[Symbol.asyncIterator]():e[Symbol.iterator]();return e5({start(){},async pull(e){let{done:s,value:r}=await t.next();s?e.close():e.enqueue(r)},async cancel(){await t.return?.()}})}function e9(e){if(e[Symbol.asyncIterator])return e;let t=e.getReader();return{async next(){try{let e=await t.read();return e?.done&&t.releaseLock(),e}catch(e){throw t.releaseLock(),e}},async return(){let e=t.cancel();return t.releaseLock(),await e,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}async function e3(e){if(null===e||"object"!=typeof e)return;if(e[Symbol.asyncIterator])return void await e[Symbol.asyncIterator]().return?.();let t=e.getReader(),s=t.cancel();t.releaseLock(),await s}let e8=({headers:e,body:t})=>({bodyHeaders:{"content-type":"application/json"},body:JSON.stringify(t)});function e7(e){let t;return(s??(s=(t=new globalThis.TextEncoder).encode.bind(t)))(e)}function te(e){let t;return(r??(r=(t=new globalThis.TextDecoder).decode.bind(t)))(e)}class tt{constructor(){n.set(this,void 0),a.set(this,void 0),eO(this,n,new Uint8Array,"f"),eO(this,a,null,"f")}decode(e){let t;if(null==e)return[];let s=e instanceof ArrayBuffer?new Uint8Array(e):"string"==typeof e?e7(e):e;eO(this,n,function(e){let t=0;for(let s of e)t+=s.length;let s=new Uint8Array(t),r=0;for(let t of e)s.set(t,r),r+=t.length;return s}([eI(this,n,"f"),s]),"f");let r=[];for(;null!=(t=function(e,t){for(let s=t??0;s<e.length;s++){if(10===e[s])return{preceding:s,index:s+1,carriage:!1};if(13===e[s])return{preceding:s,index:s+1,carriage:!0}}return null}(eI(this,n,"f"),eI(this,a,"f")));){if(t.carriage&&null==eI(this,a,"f")){eO(this,a,t.index,"f");continue}if(null!=eI(this,a,"f")&&(t.index!==eI(this,a,"f")+1||t.carriage)){r.push(te(eI(this,n,"f").subarray(0,eI(this,a,"f")-1))),eO(this,n,eI(this,n,"f").subarray(eI(this,a,"f")),"f"),eO(this,a,null,"f");continue}let e=null!==eI(this,a,"f")?t.preceding-1:t.preceding,s=te(eI(this,n,"f").subarray(0,e));r.push(s),eO(this,n,eI(this,n,"f").subarray(t.index),"f"),eO(this,a,null,"f")}return r}flush(){return eI(this,n,"f").length?this.decode("\n"):[]}}n=new WeakMap,a=new WeakMap,tt.NEWLINE_CHARS=new Set(["\n","\r"]),tt.NEWLINE_REGEXP=/\r\n|[\n\r]/g;let ts={off:0,error:200,warn:300,info:400,debug:500},tr=(e,t,s)=>{if(e){if(Object.prototype.hasOwnProperty.call(ts,e))return e;tl(s).warn(`${t} was set to ${JSON.stringify(e)}, expected one of ${JSON.stringify(Object.keys(ts))}`)}};function tn(){}function ta(e,t,s){return!t||ts[e]>ts[s]?tn:t[e].bind(t)}let ti={error:tn,warn:tn,info:tn,debug:tn},to=new WeakMap;function tl(e){let t=e.logger,s=e.logLevel??"off";if(!t)return ti;let r=to.get(t);if(r&&r[0]===s)return r[1];let n={error:ta("error",t,s),warn:ta("warn",t,s),info:ta("info",t,s),debug:ta("debug",t,s)};return to.set(t,[s,n]),n}let tc=e=>(e.options&&(e.options={...e.options},delete e.options.headers),e.headers&&(e.headers=Object.fromEntries((e.headers instanceof Headers?[...e.headers]:Object.entries(e.headers)).map(([e,t])=>[e,"x-api-key"===e.toLowerCase()||"authorization"===e.toLowerCase()||"cookie"===e.toLowerCase()||"set-cookie"===e.toLowerCase()?"***":t]))),"retryOfRequestLogID"in e&&(e.retryOfRequestLogID&&(e.retryOf=e.retryOfRequestLogID),delete e.retryOfRequestLogID),e);class tu{constructor(e,t,s){this.iterator=e,i.set(this,void 0),this.controller=t,eO(this,i,s,"f")}static fromSSEResponse(e,t,s){let r=!1,n=s?tl(s):console;async function*a(){if(r)throw new eC("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let s=!1;try{for await(let s of th(e,t)){if("completion"===s.event)try{yield JSON.parse(s.data)}catch(e){throw n.error("Could not parse message into JSON:",s.data),n.error("From chunk:",s.raw),e}if("message_start"===s.event||"message_delta"===s.event||"message_stop"===s.event||"content_block_start"===s.event||"content_block_delta"===s.event||"content_block_stop"===s.event)try{yield JSON.parse(s.data)}catch(e){throw n.error("Could not parse message into JSON:",s.data),n.error("From chunk:",s.raw),e}if("ping"!==s.event&&"error"===s.event)throw new eU(void 0,e0(s.data)??s.data,void 0,e.headers)}s=!0}catch(e){if(ej(e))return;throw e}finally{s||t.abort()}}return new tu(a,t,s)}static fromReadableStream(e,t,s){let r=!1;async function*n(){let t=new tt;for await(let s of e9(e))for(let e of t.decode(s))yield e;for(let e of t.flush())yield e}return new tu(async function*(){if(r)throw new eC("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let e=!1;try{for await(let t of n())!e&&t&&(yield JSON.parse(t));e=!0}catch(e){if(ej(e))return;throw e}finally{e||t.abort()}},t,s)}[(i=new WeakMap,Symbol.asyncIterator)](){return this.iterator()}tee(){let e=[],t=[],s=this.iterator(),r=r=>({next:()=>{if(0===r.length){let r=s.next();e.push(r),t.push(r)}return r.shift()}});return[new tu(()=>r(e),this.controller,eI(this,i,"f")),new tu(()=>r(t),this.controller,eI(this,i,"f"))]}toReadableStream(){let e,t=this;return e5({async start(){e=t[Symbol.asyncIterator]()},async pull(t){try{let{value:s,done:r}=await e.next();if(r)return t.close();let n=e7(JSON.stringify(s)+"\n");t.enqueue(n)}catch(e){t.error(e)}},async cancel(){await e.return?.()}})}}async function*th(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eC("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eC("Attempted to iterate over a response with no body")}let s=new tp,r=new tt;for await(let t of td(e9(e.body)))for(let e of r.decode(t)){let t=s.decode(e);t&&(yield t)}for(let e of r.flush()){let t=s.decode(e);t&&(yield t)}}async function*td(e){let t=new Uint8Array;for await(let s of e){let e;if(null==s)continue;let r=s instanceof ArrayBuffer?new Uint8Array(s):"string"==typeof s?e7(s):s,n=new Uint8Array(t.length+r.length);for(n.set(t),n.set(r,t.length),t=n;-1!==(e=function(e){for(let t=0;t<e.length-1;t++){if(10===e[t]&&10===e[t+1]||13===e[t]&&13===e[t+1])return t+2;if(13===e[t]&&10===e[t+1]&&t+3<e.length&&13===e[t+2]&&10===e[t+3])return t+4}return -1}(t));)yield t.slice(0,e),t=t.slice(e)}t.length>0&&(yield t)}class tp{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){var t;let s;if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;let e={event:this.event,data:this.data.join("\n"),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],e}if(this.chunks.push(e),e.startsWith(":"))return null;let[r,n,a]=-1!==(s=(t=e).indexOf(":"))?[t.substring(0,s),":",t.substring(s+1)]:[t,"",""];return a.startsWith(" ")&&(a=a.substring(1)),"event"===r?this.event=a:"data"===r&&this.data.push(a),null}}async function tf(e,t){let{response:s,requestLogID:r,retryOfRequestLogID:n,startTime:a}=t,i=await (async()=>{if(t.options.stream)return(tl(e).debug("response",s.status,s.url,s.headers,s.body),t.options.__streamClass)?t.options.__streamClass.fromSSEResponse(s,t.controller):tu.fromSSEResponse(s,t.controller);if(204===s.status)return null;if(t.options.__binaryResponse)return s;let r=s.headers.get("content-type"),n=r?.split(";")[0]?.trim();return n?.includes("application/json")||n?.endsWith("+json")?tm(await s.json(),s):await s.text()})();return tl(e).debug(`[${r}] response parsed`,tc({retryOfRequestLogID:n,url:s.url,status:s.status,body:i,durationMs:Date.now()-a})),i}function tm(e,t){return!e||"object"!=typeof e||Array.isArray(e)?e:Object.defineProperty(e,"_request_id",{value:t.headers.get("request-id"),enumerable:!1})}class tg extends Promise{constructor(e,t,s=tf){super(e=>{e(null)}),this.responsePromise=t,this.parseResponse=s,o.set(this,void 0),eO(this,o,e,"f")}_thenUnwrap(e){return new tg(eI(this,o,"f"),this.responsePromise,async(t,s)=>tm(e(await this.parseResponse(t,s),s),s.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){let[e,t]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:t,request_id:t.headers.get("request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(e=>this.parseResponse(eI(this,o,"f"),e))),this.parsedPromise}then(e,t){return this.parse().then(e,t)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}o=new WeakMap;class ty{constructor(e,t,s,r){l.set(this,void 0),eO(this,l,e,"f"),this.options=r,this.response=t,this.body=s}hasNextPage(){return!!this.getPaginatedItems().length&&null!=this.nextPageRequestOptions()}async getNextPage(){let e=this.nextPageRequestOptions();if(!e)throw new eC("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");return await eI(this,l,"f").requestAPIList(this.constructor,e)}async *iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async *[(l=new WeakMap,Symbol.asyncIterator)](){for await(let e of this.iterPages())for(let t of e.getPaginatedItems())yield t}}class tw extends tg{constructor(e,t,s){super(e,t,async(e,t)=>new s(e,t.response,await tf(e,t),t.options))}async *[Symbol.asyncIterator](){for await(let e of(await this))yield e}}class tb extends ty{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.has_more=s.has_more||!1,this.first_id=s.first_id||null,this.last_id=s.last_id||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){if(this.options.query?.before_id){let e=this.first_id;return e?{...this.options,query:{...eZ(this.options.query),before_id:e}}:null}let e=this.last_id;return e?{...this.options,query:{...eZ(this.options.query),after_id:e}}:null}}class tv extends ty{constructor(e,t,s,r){super(e,t,s,r),this.data=s.data||[],this.has_more=s.has_more||!1,this.next_page=s.next_page||null}getPaginatedItems(){return this.data??[]}hasNextPage(){return!1!==this.has_more&&super.hasNextPage()}nextPageRequestOptions(){let e=this.next_page;return e?{...this.options,query:{...eZ(this.options.query),page:e}}:null}}let t_=()=>{if("undefined"==typeof File){let{process:e}=globalThis;throw Error("`File` is not defined as a global, which is required for file uploads."+("string"==typeof e?.versions?.node&&20>parseInt(e.versions.node.split("."))?" Update to Node 20 LTS or newer, or set `globalThis.File` to `import('node:buffer').File`.":""))}};function tk(e,t,s){return t_(),new File(e,t??"unknown_file",s)}function tS(e){return("object"==typeof e&&null!==e&&("name"in e&&e.name&&String(e.name)||"url"in e&&e.url&&String(e.url)||"filename"in e&&e.filename&&String(e.filename)||"path"in e&&e.path&&String(e.path))||"").split(/[\\/]/).pop()||void 0}let tx=e=>null!=e&&"object"==typeof e&&"function"==typeof e[Symbol.asyncIterator],tR=async(e,t)=>({...e,body:await tA(e.body,t)}),tM=new WeakMap,tA=async(e,t)=>{if(!await function(e){let t="function"==typeof e?e:e.fetch,s=tM.get(t);if(s)return s;let r=(async()=>{try{let e="Response"in t?t.Response:(await t("data:,")).constructor,s=new FormData;if(s.toString()===await new e(s).text())return!1;return!0}catch{return!0}})();return tM.set(t,r),r}(t))throw TypeError("The provided fetch function does not support file uploads with the current global FormData class.");let s=new FormData;return await Promise.all(Object.entries(e||{}).map(([e,t])=>tT(s,e,t))),s},tP=e=>e instanceof Blob&&"name"in e,tE=e=>{if("object"==typeof e&&null!==e&&(e instanceof Response||tx(e)||tP(e)))return!0;if(Array.isArray(e))return e.some(tE);if(e&&"object"==typeof e){for(let t in e)if(tE(e[t]))return!0}return!1},tT=async(e,t,s)=>{if(void 0!==s){if(null==s)throw TypeError(`Received null for "${t}"; to pass null in FormData, you must use the string 'null'`);if("string"==typeof s||"number"==typeof s||"boolean"==typeof s)e.append(t,String(s));else if(s instanceof Response){let r={},n=s.headers.get("Content-Type");n&&(r={type:n}),e.append(t,tk([await s.blob()],tS(s),r))}else if(tx(s))e.append(t,tk([await new Response(e6(s)).blob()],tS(s)));else if(tP(s))e.append(t,tk([s],tS(s),{type:s.type}));else if(Array.isArray(s))await Promise.all(s.map(s=>tT(e,t+"[]",s)));else if("object"==typeof s)await Promise.all(Object.entries(s).map(([s,r])=>tT(e,`${t}[${s}]`,r)));else throw TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${s} instead`)}},t$=e=>null!=e&&"object"==typeof e&&"number"==typeof e.size&&"string"==typeof e.type&&"function"==typeof e.text&&"function"==typeof e.slice&&"function"==typeof e.arrayBuffer;async function tO(e,t,s){let r,n;if(t_(),e=await e,t||(t=tS(e)),null!=(r=e)&&"object"==typeof r&&"string"==typeof r.name&&"number"==typeof r.lastModified&&t$(r))return e instanceof File&&null==t&&null==s?e:tk([await e.arrayBuffer()],t??e.name,{type:e.type,lastModified:e.lastModified,...s});if(null!=(n=e)&&"object"==typeof n&&"string"==typeof n.url&&"function"==typeof n.blob){let r=await e.blob();return t||(t=new URL(e.url).pathname.split(/[\\/]/).pop()),tk(await tI(r),t,s)}let a=await tI(e);if(!s?.type){let e=a.find(e=>"object"==typeof e&&"type"in e&&e.type);"string"==typeof e&&(s={...s,type:e})}return tk(a,t,s)}async function tI(e){let t=[];if("string"==typeof e||ArrayBuffer.isView(e)||e instanceof ArrayBuffer)t.push(e);else if(t$(e))t.push(e instanceof Blob?e:await e.arrayBuffer());else if(tx(e))for await(let s of e)t.push(...await tI(s));else{let t=e?.constructor?.name;throw Error(`Unexpected data type: ${typeof e}${t?`; constructor: ${t}`:""}${function(e){if("object"!=typeof e||null===e)return"";let t=Object.getOwnPropertyNames(e);return`; props: [${t.map(e=>`"${e}"`).join(", ")}]`}(e)}`)}return t}class tN{constructor(e){this._client=e}}let tj=Symbol.for("brand.privateNullableHeaders"),tq=e=>{let t=new Headers,s=new Set;for(let r of e){let e=new Set;for(let[n,a]of function*(e){let t;if(!e)return;if(tj in e){let{values:t,nulls:s}=e;for(let e of(yield*t.entries(),s))yield[e,null];return}let s=!1;for(let r of(e instanceof Headers?t=e.entries():eY(e)?t=e:(s=!0,t=Object.entries(e??{})),t)){let e=r[0];if("string"!=typeof e)throw TypeError("expected header name to be a string");let t=eY(r[1])?r[1]:[r[1]],n=!1;for(let r of t)void 0!==r&&(s&&!n&&(n=!0,yield[e,null]),yield[e,r])}}(r)){let r=n.toLowerCase();e.has(r)||(t.delete(n),e.add(r)),null===a?(t.delete(n),s.add(r)):(t.append(n,a),s.delete(r))}}return{[tj]:!0,values:t,nulls:s}};function tC(e){return e.replace(/[^A-Za-z0-9\-._~!$&'()*+,;=:@]+/g,encodeURIComponent)}let tU=Object.freeze(Object.create(null)),tL=((e=tC)=>function(t,...s){let r;if(1===t.length)return t[0];let n=!1,a=[],i=t.reduce((t,r,i)=>{/[?#]/.test(r)&&(n=!0);let o=s[i],l=(n?encodeURIComponent:e)(""+o);return i!==s.length&&(null==o||"object"==typeof o&&o.toString===Object.getPrototypeOf(Object.getPrototypeOf(o.hasOwnProperty??tU)??tU)?.toString)&&(l=o+"",a.push({start:t.length+r.length,length:l.length,error:`Value of type ${Object.prototype.toString.call(o).slice(8,-1)} is not a valid path parameter`})),t+r+(i===s.length?"":l)},""),o=i.split(/[?#]/,1)[0],l=/(?<=^|\/)(?:\.|%2e){1,2}(?=\/|$)/gi;for(;null!==(r=l.exec(o));)a.push({start:r.index,length:r[0].length,error:`Value "${r[0]}" can't be safely passed as a path parameter`});if(a.sort((e,t)=>e.start-t.start),a.length>0){let e=0,t=a.reduce((t,s)=>{let r=" ".repeat(s.start-e),n="^".repeat(s.length);return e=s.start+s.length,t+r+n},"");throw new eC(`Path parameters result in path with invalid segments:
${a.map(e=>e.error).join("\n")}
${i}
${t}`)}return i})(tC);class tW extends tN{list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/files",tb,{query:r,...t,headers:tq([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},t?.headers])})}delete(e,t={},s){let{betas:r}=t??{};return this._client.delete(tL`/v1/files/${e}`,{...s,headers:tq([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},s?.headers])})}download(e,t={},s){let{betas:r}=t??{};return this._client.get(tL`/v1/files/${e}/content`,{...s,headers:tq([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString(),Accept:"application/binary"},s?.headers]),__binaryResponse:!0})}retrieveMetadata(e,t={},s){let{betas:r}=t??{};return this._client.get(tL`/v1/files/${e}`,{...s,headers:tq([{"anthropic-beta":[...r??[],"files-api-2025-04-14"].toString()},s?.headers])})}upload(e,t){let{betas:s,...r}=e;return this._client.post("/v1/files",tR({body:r,...t,headers:tq([{"anthropic-beta":[...s??[],"files-api-2025-04-14"].toString()},t?.headers])},this._client))}}class tH extends tN{retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tL`/v1/models/${e}?beta=true`,{...s,headers:tq([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/models?beta=true",tb,{query:r,...t,headers:tq([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers])})}}class tD{constructor(e,t){this.iterator=e,this.controller=t}async *decoder(){let e=new tt;for await(let t of this.iterator)for(let s of e.decode(t))yield JSON.parse(s);for(let t of e.flush())yield JSON.parse(t)}[Symbol.asyncIterator](){return this.decoder()}static fromResponse(e,t){if(!e.body){if(t.abort(),void 0!==globalThis.navigator&&"ReactNative"===globalThis.navigator.product)throw new eC("The default react-native fetch implementation does not support streaming. Please use expo/fetch: https://docs.expo.dev/versions/latest/sdk/expo/#expofetch-api");throw new eC("Attempted to iterate over a response with no body")}return new tD(e9(e.body),t)}}class tF extends tN{create(e,t){let{betas:s,...r}=e;return this._client.post("/v1/messages/batches?beta=true",{body:r,...t,headers:tq([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},t?.headers])})}retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tL`/v1/messages/batches/${e}?beta=true`,{...s,headers:tq([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/messages/batches?beta=true",tb,{query:r,...t,headers:tq([{"anthropic-beta":[...s??[],"message-batches-2024-09-24"].toString()},t?.headers])})}delete(e,t={},s){let{betas:r}=t??{};return this._client.delete(tL`/v1/messages/batches/${e}?beta=true`,{...s,headers:tq([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},s?.headers])})}cancel(e,t={},s){let{betas:r}=t??{};return this._client.post(tL`/v1/messages/batches/${e}/cancel?beta=true`,{...s,headers:tq([{"anthropic-beta":[...r??[],"message-batches-2024-09-24"].toString()},s?.headers])})}async results(e,t={},s){let r=await this.retrieve(e);if(!r.results_url)throw new eC(`No batch \`results_url\`; Has it finished processing? ${r.processing_status} - ${r.id}`);let{betas:n}=t??{};return this._client.get(r.results_url,{...s,headers:tq([{"anthropic-beta":[...n??[],"message-batches-2024-09-24"].toString(),Accept:"application/binary"},s?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((e,t)=>tD.fromResponse(t.response,t.controller))}}let tX=e=>{if(0===e.length)return e;let t=e[e.length-1];switch(t.type){case"separator":return tX(e=e.slice(0,e.length-1));case"number":let s=t.value[t.value.length-1];if("."===s||"-"===s)return tX(e=e.slice(0,e.length-1));case"string":let r=e[e.length-2];if(r?.type==="delimiter"||r?.type==="brace"&&"{"===r.value)return tX(e=e.slice(0,e.length-1));break;case"delimiter":return tX(e=e.slice(0,e.length-1))}return e},tB=e=>{var t;let s,r;return JSON.parse((t=tX((e=>{let t=0,s=[];for(;t<e.length;){let r=e[t];if("\\"===r){t++;continue}if("{"===r){s.push({type:"brace",value:"{"}),t++;continue}if("}"===r){s.push({type:"brace",value:"}"}),t++;continue}if("["===r){s.push({type:"paren",value:"["}),t++;continue}if("]"===r){s.push({type:"paren",value:"]"}),t++;continue}if(":"===r){s.push({type:"separator",value:":"}),t++;continue}if(","===r){s.push({type:"delimiter",value:","}),t++;continue}if('"'===r){let n="",a=!1;for(r=e[++t];'"'!==r;){if(t===e.length){a=!0;break}if("\\"===r){if(++t===e.length){a=!0;break}n+=r+e[t],r=e[++t]}else n+=r,r=e[++t]}r=e[++t],a||s.push({type:"string",value:n});continue}let n=/\s/;if(r&&n.test(r)){t++;continue}let a=/[0-9]/;if(r&&a.test(r)||"-"===r||"."===r){let n="";for("-"===r&&(n+=r,r=e[++t]);r&&a.test(r)||"."===r;)n+=r,r=e[++t];s.push({type:"number",value:n});continue}let i=/[a-z]/i;if(r&&i.test(r)){let n="";for(;r&&i.test(r)&&t!==e.length;)n+=r,r=e[++t];"true"==n||"false"==n||"null"===n?s.push({type:"name",value:n}):t++;continue}t++}return s})(e)),s=[],t.map(e=>{"brace"===e.type&&("{"===e.value?s.push("}"):s.splice(s.lastIndexOf("}"),1)),"paren"===e.type&&("["===e.value?s.push("]"):s.splice(s.lastIndexOf("]"),1))}),s.length>0&&s.reverse().map(e=>{"}"===e?t.push({type:"brace",value:"}"}):"]"===e&&t.push({type:"paren",value:"]"})}),r="",t.map(e=>{"string"===e.type?r+='"'+e.value+'"':r+=e.value}),r))},tK="__json_buf";function tJ(e){return"tool_use"===e.type||"server_tool_use"===e.type||"mcp_tool_use"===e.type}class tV{constructor(){c.add(this),this.messages=[],this.receivedMessages=[],u.set(this,void 0),this.controller=new AbortController,h.set(this,void 0),d.set(this,()=>{}),p.set(this,()=>{}),f.set(this,void 0),m.set(this,()=>{}),g.set(this,()=>{}),y.set(this,{}),w.set(this,!1),b.set(this,!1),v.set(this,!1),_.set(this,!1),k.set(this,void 0),S.set(this,void 0),M.set(this,e=>{if(eO(this,b,!0,"f"),ej(e)&&(e=new eL),e instanceof eL)return eO(this,v,!0,"f"),this._emit("abort",e);if(e instanceof eC)return this._emit("error",e);if(e instanceof Error){let t=new eC(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eC(String(e)))}),eO(this,h,new Promise((e,t)=>{eO(this,d,e,"f"),eO(this,p,t,"f")}),"f"),eO(this,f,new Promise((e,t)=>{eO(this,m,e,"f"),eO(this,g,t,"f")}),"f"),eI(this,h,"f").catch(()=>{}),eI(this,f,"f").catch(()=>{})}get response(){return eI(this,k,"f")}get request_id(){return eI(this,S,"f")}async withResponse(){let e=await eI(this,h,"f");if(!e)throw Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let t=new tV;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,s){let r=new tV;for(let e of t.messages)r._addMessageParam(e);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},eI(this,M,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,s){let r,n=s?.signal;n&&(n.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),n.addEventListener("abort",r));try{eI(this,c,"m",A).call(this);let{response:r,data:n}=await e.create({...t,stream:!0},{...s,signal:this.controller.signal}).withResponse();for await(let e of(this._connected(r),n))eI(this,c,"m",P).call(this,e);if(n.controller.signal?.aborted)throw new eL;eI(this,c,"m",E).call(this)}finally{n&&r&&n.removeEventListener("abort",r)}}_connected(e){this.ended||(eO(this,k,e,"f"),eO(this,S,e?.headers.get("request-id"),"f"),eI(this,d,"f").call(this,e),this._emit("connect"))}get ended(){return eI(this,w,"f")}get errored(){return eI(this,b,"f")}get aborted(){return eI(this,v,"f")}abort(){this.controller.abort()}on(e,t){return(eI(this,y,"f")[e]||(eI(this,y,"f")[e]=[])).push({listener:t}),this}off(e,t){let s=eI(this,y,"f")[e];if(!s)return this;let r=s.findIndex(e=>e.listener===t);return r>=0&&s.splice(r,1),this}once(e,t){return(eI(this,y,"f")[e]||(eI(this,y,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{eO(this,_,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)})}async done(){eO(this,_,!0,"f"),await eI(this,f,"f")}get currentMessage(){return eI(this,u,"f")}async finalMessage(){return await this.done(),eI(this,c,"m",x).call(this)}async finalText(){return await this.done(),eI(this,c,"m",R).call(this)}_emit(e,...t){if(eI(this,w,"f"))return;"end"===e&&(eO(this,w,!0,"f"),eI(this,m,"f").call(this));let s=eI(this,y,"f")[e];if(s&&(eI(this,y,"f")[e]=s.filter(e=>!e.once),s.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];eI(this,_,"f")||s?.length||Promise.reject(e),eI(this,p,"f").call(this,e),eI(this,g,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];eI(this,_,"f")||s?.length||Promise.reject(e),eI(this,p,"f").call(this,e),eI(this,g,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",eI(this,c,"m",x).call(this))}async _fromReadableStream(e,t){let s,r=t?.signal;r&&(r.aborted&&this.controller.abort(),s=this.controller.abort.bind(this.controller),r.addEventListener("abort",s));try{eI(this,c,"m",A).call(this),this._connected(null);let t=tu.fromReadableStream(e,this.controller);for await(let e of t)eI(this,c,"m",P).call(this,e);if(t.controller.signal?.aborted)throw new eL;eI(this,c,"m",E).call(this)}finally{r&&s&&r.removeEventListener("abort",s)}}[(u=new WeakMap,h=new WeakMap,d=new WeakMap,p=new WeakMap,f=new WeakMap,m=new WeakMap,g=new WeakMap,y=new WeakMap,w=new WeakMap,b=new WeakMap,v=new WeakMap,_=new WeakMap,k=new WeakMap,S=new WeakMap,M=new WeakMap,c=new WeakSet,x=function(){if(0===this.receivedMessages.length)throw new eC("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},R=function(){if(0===this.receivedMessages.length)throw new eC("stream ended without producing a Message with role=assistant");let e=this.receivedMessages.at(-1).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===e.length)throw new eC("stream ended without producing a content block with type=text");return e.join(" ")},A=function(){this.ended||eO(this,u,void 0,"f")},P=function(e){if(this.ended)return;let t=eI(this,c,"m",T).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{let s=t.content.at(-1);switch(e.delta.type){case"text_delta":"text"===s.type&&this._emit("text",e.delta.text,s.text||"");break;case"citations_delta":"text"===s.type&&this._emit("citation",e.delta.citation,s.citations??[]);break;case"input_json_delta":tJ(s)&&s.input&&this._emit("inputJson",e.delta.partial_json,s.input);break;case"thinking_delta":"thinking"===s.type&&this._emit("thinking",e.delta.thinking,s.thinking);break;case"signature_delta":"thinking"===s.type&&this._emit("signature",s.signature);break;default:tz(e.delta)}break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":eO(this,u,t,"f")}},E=function(){if(this.ended)throw new eC("stream has ended, this shouldn't happen");let e=eI(this,u,"f");if(!e)throw new eC("request ended without sending any chunks");return eO(this,u,void 0,"f"),e},T=function(e){let t=eI(this,u,"f");if("message_start"===e.type){if(t)throw new eC(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new eC(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.container=e.delta.container,t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,t.context_management=e.context_management,null!=e.usage.input_tokens&&(t.usage.input_tokens=e.usage.input_tokens),null!=e.usage.cache_creation_input_tokens&&(t.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),null!=e.usage.cache_read_input_tokens&&(t.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),null!=e.usage.server_tool_use&&(t.usage.server_tool_use=e.usage.server_tool_use),t;case"content_block_start":return t.content.push(e.content_block),t;case"content_block_delta":{let s=t.content.at(e.index);switch(e.delta.type){case"text_delta":s?.type==="text"&&(t.content[e.index]={...s,text:(s.text||"")+e.delta.text});break;case"citations_delta":s?.type==="text"&&(t.content[e.index]={...s,citations:[...s.citations??[],e.delta.citation]});break;case"input_json_delta":if(s&&tJ(s)){let r=s[tK]||"";r+=e.delta.partial_json;let n={...s};if(Object.defineProperty(n,tK,{value:r,enumerable:!1,writable:!0}),r)try{n.input=tB(r)}catch(t){let e=new eC(`Unable to parse tool parameter JSON from model. Please retry your request or adjust your prompt. Error: ${t}. JSON: ${r}`);eI(this,M,"f").call(this,e)}t.content[e.index]=n}break;case"thinking_delta":s?.type==="thinking"&&(t.content[e.index]={...s,thinking:s.thinking+e.delta.thinking});break;case"signature_delta":s?.type==="thinking"&&(t.content[e.index]={...s,signature:e.delta.signature});break;default:tz(e.delta)}return t}}},Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("streamEvent",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new tu(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function tz(e){}let tG={"claude-opus-4-20250514":8192,"claude-opus-4-0":8192,"claude-4-opus-20250514":8192,"anthropic.claude-opus-4-20250514-v1:0":8192,"claude-opus-4@20250514":8192,"claude-opus-4-1-20250805":8192,"anthropic.claude-opus-4-1-20250805-v1:0":8192,"claude-opus-4-1@20250805":8192};function tQ(){let e,t;return{promise:new Promise((s,r)=>{e=s,t=r}),resolve:e,reject:t}}class tY{constructor(e,t,s){$.add(this),this.client=e,O.set(this,!1),I.set(this,!1),N.set(this,void 0),j.set(this,void 0),q.set(this,void 0),C.set(this,void 0),U.set(this,void 0),L.set(this,0),eO(this,N,{params:{...t,messages:structuredClone(t.messages)}},"f"),eO(this,j,{...s,headers:tq([{"x-stainless-helper":"BetaToolRunner"},s?.headers])},"f"),eO(this,U,tQ(),"f")}async *[(O=new WeakMap,I=new WeakMap,N=new WeakMap,j=new WeakMap,q=new WeakMap,C=new WeakMap,U=new WeakMap,L=new WeakMap,$=new WeakSet,Symbol.asyncIterator)](){var e;if(eI(this,O,"f"))throw new eC("Cannot iterate over a consumed stream");eO(this,O,!0,"f"),eO(this,I,!0,"f"),eO(this,C,void 0,"f");try{for(;;){let t;try{if(eI(this,N,"f").params.max_iterations&&eI(this,L,"f")>=eI(this,N,"f").params.max_iterations)break;eO(this,I,!1,"f"),eO(this,q,void 0,"f"),eO(this,C,void 0,"f"),eO(this,L,(e=eI(this,L,"f"),++e),"f");let{max_iterations:s,...r}=eI(this,N,"f").params;if(r.stream?(t=this.client.beta.messages.stream({...r},eI(this,j,"f")),eO(this,q,t.finalMessage(),"f"),eI(this,q,"f").catch(()=>{}),yield t):(eO(this,q,this.client.beta.messages.create({...r,stream:!1},eI(this,j,"f")),"f"),yield eI(this,q,"f")),!eI(this,I,"f")){let{role:e,content:t}=await eI(this,q,"f");eI(this,N,"f").params.messages.push({role:e,content:t})}let n=await eI(this,$,"m",W).call(this,eI(this,N,"f").params.messages.at(-1));if(n&&eI(this,N,"f").params.messages.push(n),!n&&!eI(this,I,"f"))break}finally{t&&t.abort()}}if(!eI(this,q,"f"))throw new eC("ToolRunner concluded without a message from the server");eI(this,U,"f").resolve(await eI(this,q,"f"))}catch(e){throw eO(this,O,!1,"f"),eI(this,U,"f").promise.catch(()=>{}),eI(this,U,"f").reject(e),eO(this,U,tQ(),"f"),e}}setMessagesParams(e){"function"==typeof e?eI(this,N,"f").params=e(eI(this,N,"f").params):eI(this,N,"f").params=e,eO(this,I,!0,"f"),eO(this,C,void 0,"f")}async generateToolResponse(){let e=await eI(this,q,"f")??this.params.messages.at(-1);return e?eI(this,$,"m",W).call(this,e):null}done(){return eI(this,U,"f").promise}async runUntilDone(){if(!eI(this,O,"f"))for await(let e of this);return this.done()}get params(){return eI(this,N,"f").params}pushMessages(...e){this.setMessagesParams(t=>({...t,messages:[...t.messages,...e]}))}then(e,t){return this.runUntilDone().then(e,t)}}async function tZ(e,t=e.messages.at(-1)){if(!t||"assistant"!==t.role||!t.content||"string"==typeof t.content)return null;let s=t.content.filter(e=>"tool_use"===e.type);return 0===s.length?null:{role:"user",content:await Promise.all(s.map(async t=>{let s=e.tools.find(e=>e.name===t.name);if(!s||!("run"in s))return{type:"tool_result",tool_use_id:t.id,content:`Error: Tool '${t.name}' not found`,is_error:!0};try{let e=t.input;"parse"in s&&s.parse&&(e=s.parse(e));let r=await s.run(e);return{type:"tool_result",tool_use_id:t.id,content:r}}catch(e){return{type:"tool_result",tool_use_id:t.id,content:`Error: ${e instanceof Error?e.message:String(e)}`,is_error:!0}}}))}}W=async function(e){return void 0!==eI(this,C,"f")||eO(this,C,tZ(eI(this,N,"f").params,e),"f"),eI(this,C,"f")};let t0={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-7-sonnet-latest":"February 19th, 2026","claude-3-7-sonnet-20250219":"February 19th, 2026"};class t1 extends tN{constructor(){super(...arguments),this.batches=new tF(this._client)}create(e,t){let{betas:s,...r}=e;r.model in t0&&console.warn(`The model '${r.model}' is deprecated and will reach end-of-life on ${t0[r.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let n=this._client._options.timeout;if(!r.stream&&null==n){let e=tG[r.model]??void 0;n=this._client.calculateNonstreamingTimeout(r.max_tokens,e)}return this._client.post("/v1/messages?beta=true",{body:r,timeout:n??6e5,...t,headers:tq([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers]),stream:e.stream??!1})}stream(e,t){return tV.createMessage(this,e,t)}countTokens(e,t){let{betas:s,...r}=e;return this._client.post("/v1/messages/count_tokens?beta=true",{body:r,...t,headers:tq([{"anthropic-beta":[...s??[],"token-counting-2024-11-01"].toString()},t?.headers])})}toolRunner(e,t){return new tY(this._client,e,t)}}t1.Batches=tF,t1.BetaToolRunner=tY;class t2 extends tN{create(e,t={},s){let{betas:r,...n}=t??{};return this._client.post(tL`/v1/skills/${e}/versions?beta=true`,tR({body:n,...s,headers:tq([{"anthropic-beta":[...r??[],"skills-2025-10-02"].toString()},s?.headers])},this._client))}retrieve(e,t,s){let{skill_id:r,betas:n}=t;return this._client.get(tL`/v1/skills/${r}/versions/${e}?beta=true`,{...s,headers:tq([{"anthropic-beta":[...n??[],"skills-2025-10-02"].toString()},s?.headers])})}list(e,t={},s){let{betas:r,...n}=t??{};return this._client.getAPIList(tL`/v1/skills/${e}/versions?beta=true`,tv,{query:n,...s,headers:tq([{"anthropic-beta":[...r??[],"skills-2025-10-02"].toString()},s?.headers])})}delete(e,t,s){let{skill_id:r,betas:n}=t;return this._client.delete(tL`/v1/skills/${r}/versions/${e}?beta=true`,{...s,headers:tq([{"anthropic-beta":[...n??[],"skills-2025-10-02"].toString()},s?.headers])})}}class t4 extends tN{constructor(){super(...arguments),this.versions=new t2(this._client)}create(e={},t){let{betas:s,...r}=e??{};return this._client.post("/v1/skills?beta=true",tR({body:r,...t,headers:tq([{"anthropic-beta":[...s??[],"skills-2025-10-02"].toString()},t?.headers])},this._client))}retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tL`/v1/skills/${e}?beta=true`,{...s,headers:tq([{"anthropic-beta":[...r??[],"skills-2025-10-02"].toString()},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/skills?beta=true",tv,{query:r,...t,headers:tq([{"anthropic-beta":[...s??[],"skills-2025-10-02"].toString()},t?.headers])})}delete(e,t={},s){let{betas:r}=t??{};return this._client.delete(tL`/v1/skills/${e}?beta=true`,{...s,headers:tq([{"anthropic-beta":[...r??[],"skills-2025-10-02"].toString()},s?.headers])})}}t4.Versions=t2;class t5 extends tN{constructor(){super(...arguments),this.models=new tH(this._client),this.messages=new t1(this._client),this.files=new tW(this._client),this.skills=new t4(this._client)}}t5.Models=tH,t5.Messages=t1,t5.Files=tW,t5.Skills=t4;class t6 extends tN{create(e,t){let{betas:s,...r}=e;return this._client.post("/v1/complete",{body:r,timeout:this._client._options.timeout??6e5,...t,headers:tq([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers]),stream:e.stream??!1})}}let t9="__json_buf";function t3(e){return"tool_use"===e.type||"server_tool_use"===e.type}class t8{constructor(){H.add(this),this.messages=[],this.receivedMessages=[],D.set(this,void 0),this.controller=new AbortController,F.set(this,void 0),X.set(this,()=>{}),B.set(this,()=>{}),K.set(this,void 0),J.set(this,()=>{}),V.set(this,()=>{}),z.set(this,{}),G.set(this,!1),Q.set(this,!1),Y.set(this,!1),Z.set(this,!1),ee.set(this,void 0),et.set(this,void 0),en.set(this,e=>{if(eO(this,Q,!0,"f"),ej(e)&&(e=new eL),e instanceof eL)return eO(this,Y,!0,"f"),this._emit("abort",e);if(e instanceof eC)return this._emit("error",e);if(e instanceof Error){let t=new eC(e.message);return t.cause=e,this._emit("error",t)}return this._emit("error",new eC(String(e)))}),eO(this,F,new Promise((e,t)=>{eO(this,X,e,"f"),eO(this,B,t,"f")}),"f"),eO(this,K,new Promise((e,t)=>{eO(this,J,e,"f"),eO(this,V,t,"f")}),"f"),eI(this,F,"f").catch(()=>{}),eI(this,K,"f").catch(()=>{})}get response(){return eI(this,ee,"f")}get request_id(){return eI(this,et,"f")}async withResponse(){let e=await eI(this,F,"f");if(!e)throw Error("Could not resolve a `Response` object");return{data:this,response:e,request_id:e.headers.get("request-id")}}static fromReadableStream(e){let t=new t8;return t._run(()=>t._fromReadableStream(e)),t}static createMessage(e,t,s){let r=new t8;for(let e of t.messages)r._addMessageParam(e);return r._run(()=>r._createMessage(e,{...t,stream:!0},{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),r}_run(e){e().then(()=>{this._emitFinal(),this._emit("end")},eI(this,en,"f"))}_addMessageParam(e){this.messages.push(e)}_addMessage(e,t=!0){this.receivedMessages.push(e),t&&this._emit("message",e)}async _createMessage(e,t,s){let r,n=s?.signal;n&&(n.aborted&&this.controller.abort(),r=this.controller.abort.bind(this.controller),n.addEventListener("abort",r));try{eI(this,H,"m",ea).call(this);let{response:r,data:n}=await e.create({...t,stream:!0},{...s,signal:this.controller.signal}).withResponse();for await(let e of(this._connected(r),n))eI(this,H,"m",ei).call(this,e);if(n.controller.signal?.aborted)throw new eL;eI(this,H,"m",eo).call(this)}finally{n&&r&&n.removeEventListener("abort",r)}}_connected(e){this.ended||(eO(this,ee,e,"f"),eO(this,et,e?.headers.get("request-id"),"f"),eI(this,X,"f").call(this,e),this._emit("connect"))}get ended(){return eI(this,G,"f")}get errored(){return eI(this,Q,"f")}get aborted(){return eI(this,Y,"f")}abort(){this.controller.abort()}on(e,t){return(eI(this,z,"f")[e]||(eI(this,z,"f")[e]=[])).push({listener:t}),this}off(e,t){let s=eI(this,z,"f")[e];if(!s)return this;let r=s.findIndex(e=>e.listener===t);return r>=0&&s.splice(r,1),this}once(e,t){return(eI(this,z,"f")[e]||(eI(this,z,"f")[e]=[])).push({listener:t,once:!0}),this}emitted(e){return new Promise((t,s)=>{eO(this,Z,!0,"f"),"error"!==e&&this.once("error",s),this.once(e,t)})}async done(){eO(this,Z,!0,"f"),await eI(this,K,"f")}get currentMessage(){return eI(this,D,"f")}async finalMessage(){return await this.done(),eI(this,H,"m",es).call(this)}async finalText(){return await this.done(),eI(this,H,"m",er).call(this)}_emit(e,...t){if(eI(this,G,"f"))return;"end"===e&&(eO(this,G,!0,"f"),eI(this,J,"f").call(this));let s=eI(this,z,"f")[e];if(s&&(eI(this,z,"f")[e]=s.filter(e=>!e.once),s.forEach(({listener:e})=>e(...t))),"abort"===e){let e=t[0];eI(this,Z,"f")||s?.length||Promise.reject(e),eI(this,B,"f").call(this,e),eI(this,V,"f").call(this,e),this._emit("end");return}if("error"===e){let e=t[0];eI(this,Z,"f")||s?.length||Promise.reject(e),eI(this,B,"f").call(this,e),eI(this,V,"f").call(this,e),this._emit("end")}}_emitFinal(){this.receivedMessages.at(-1)&&this._emit("finalMessage",eI(this,H,"m",es).call(this))}async _fromReadableStream(e,t){let s,r=t?.signal;r&&(r.aborted&&this.controller.abort(),s=this.controller.abort.bind(this.controller),r.addEventListener("abort",s));try{eI(this,H,"m",ea).call(this),this._connected(null);let t=tu.fromReadableStream(e,this.controller);for await(let e of t)eI(this,H,"m",ei).call(this,e);if(t.controller.signal?.aborted)throw new eL;eI(this,H,"m",eo).call(this)}finally{r&&s&&r.removeEventListener("abort",s)}}[(D=new WeakMap,F=new WeakMap,X=new WeakMap,B=new WeakMap,K=new WeakMap,J=new WeakMap,V=new WeakMap,z=new WeakMap,G=new WeakMap,Q=new WeakMap,Y=new WeakMap,Z=new WeakMap,ee=new WeakMap,et=new WeakMap,en=new WeakMap,H=new WeakSet,es=function(){if(0===this.receivedMessages.length)throw new eC("stream ended without producing a Message with role=assistant");return this.receivedMessages.at(-1)},er=function(){if(0===this.receivedMessages.length)throw new eC("stream ended without producing a Message with role=assistant");let e=this.receivedMessages.at(-1).content.filter(e=>"text"===e.type).map(e=>e.text);if(0===e.length)throw new eC("stream ended without producing a content block with type=text");return e.join(" ")},ea=function(){this.ended||eO(this,D,void 0,"f")},ei=function(e){if(this.ended)return;let t=eI(this,H,"m",el).call(this,e);switch(this._emit("streamEvent",e,t),e.type){case"content_block_delta":{let s=t.content.at(-1);switch(e.delta.type){case"text_delta":"text"===s.type&&this._emit("text",e.delta.text,s.text||"");break;case"citations_delta":"text"===s.type&&this._emit("citation",e.delta.citation,s.citations??[]);break;case"input_json_delta":t3(s)&&s.input&&this._emit("inputJson",e.delta.partial_json,s.input);break;case"thinking_delta":"thinking"===s.type&&this._emit("thinking",e.delta.thinking,s.thinking);break;case"signature_delta":"thinking"===s.type&&this._emit("signature",s.signature);break;default:t7(e.delta)}break}case"message_stop":this._addMessageParam(t),this._addMessage(t,!0);break;case"content_block_stop":this._emit("contentBlock",t.content.at(-1));break;case"message_start":eO(this,D,t,"f")}},eo=function(){if(this.ended)throw new eC("stream has ended, this shouldn't happen");let e=eI(this,D,"f");if(!e)throw new eC("request ended without sending any chunks");return eO(this,D,void 0,"f"),e},el=function(e){let t=eI(this,D,"f");if("message_start"===e.type){if(t)throw new eC(`Unexpected event order, got ${e.type} before receiving "message_stop"`);return e.message}if(!t)throw new eC(`Unexpected event order, got ${e.type} before "message_start"`);switch(e.type){case"message_stop":case"content_block_stop":return t;case"message_delta":return t.stop_reason=e.delta.stop_reason,t.stop_sequence=e.delta.stop_sequence,t.usage.output_tokens=e.usage.output_tokens,null!=e.usage.input_tokens&&(t.usage.input_tokens=e.usage.input_tokens),null!=e.usage.cache_creation_input_tokens&&(t.usage.cache_creation_input_tokens=e.usage.cache_creation_input_tokens),null!=e.usage.cache_read_input_tokens&&(t.usage.cache_read_input_tokens=e.usage.cache_read_input_tokens),null!=e.usage.server_tool_use&&(t.usage.server_tool_use=e.usage.server_tool_use),t;case"content_block_start":return t.content.push({...e.content_block}),t;case"content_block_delta":{let s=t.content.at(e.index);switch(e.delta.type){case"text_delta":s?.type==="text"&&(t.content[e.index]={...s,text:(s.text||"")+e.delta.text});break;case"citations_delta":s?.type==="text"&&(t.content[e.index]={...s,citations:[...s.citations??[],e.delta.citation]});break;case"input_json_delta":if(s&&t3(s)){let r=s[t9]||"";r+=e.delta.partial_json;let n={...s};Object.defineProperty(n,t9,{value:r,enumerable:!1,writable:!0}),r&&(n.input=tB(r)),t.content[e.index]=n}break;case"thinking_delta":s?.type==="thinking"&&(t.content[e.index]={...s,thinking:s.thinking+e.delta.thinking});break;case"signature_delta":s?.type==="thinking"&&(t.content[e.index]={...s,signature:e.delta.signature});break;default:t7(e.delta)}return t}}},Symbol.asyncIterator)](){let e=[],t=[],s=!1;return this.on("streamEvent",s=>{let r=t.shift();r?r.resolve(s):e.push(s)}),this.on("end",()=>{for(let e of(s=!0,t))e.resolve(void 0);t.length=0}),this.on("abort",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),this.on("error",e=>{for(let r of(s=!0,t))r.reject(e);t.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:s?{value:void 0,done:!0}:new Promise((e,s)=>t.push({resolve:e,reject:s})).then(e=>e?{value:e,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new tu(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function t7(e){}class se extends tN{create(e,t){return this._client.post("/v1/messages/batches",{body:e,...t})}retrieve(e,t){return this._client.get(tL`/v1/messages/batches/${e}`,t)}list(e={},t){return this._client.getAPIList("/v1/messages/batches",tb,{query:e,...t})}delete(e,t){return this._client.delete(tL`/v1/messages/batches/${e}`,t)}cancel(e,t){return this._client.post(tL`/v1/messages/batches/${e}/cancel`,t)}async results(e,t){let s=await this.retrieve(e);if(!s.results_url)throw new eC(`No batch \`results_url\`; Has it finished processing? ${s.processing_status} - ${s.id}`);return this._client.get(s.results_url,{...t,headers:tq([{Accept:"application/binary"},t?.headers]),stream:!0,__binaryResponse:!0})._thenUnwrap((e,t)=>tD.fromResponse(t.response,t.controller))}}class st extends tN{constructor(){super(...arguments),this.batches=new se(this._client)}create(e,t){e.model in ss&&console.warn(`The model '${e.model}' is deprecated and will reach end-of-life on ${ss[e.model]}
Please migrate to a newer model. Visit https://docs.anthropic.com/en/docs/resources/model-deprecations for more information.`);let s=this._client._options.timeout;if(!e.stream&&null==s){let t=tG[e.model]??void 0;s=this._client.calculateNonstreamingTimeout(e.max_tokens,t)}return this._client.post("/v1/messages",{body:e,timeout:s??6e5,...t,stream:e.stream??!1})}stream(e,t){return t8.createMessage(this,e,t)}countTokens(e,t){return this._client.post("/v1/messages/count_tokens",{body:e,...t})}}let ss={"claude-1.3":"November 6th, 2024","claude-1.3-100k":"November 6th, 2024","claude-instant-1.1":"November 6th, 2024","claude-instant-1.1-100k":"November 6th, 2024","claude-instant-1.2":"November 6th, 2024","claude-3-sonnet-20240229":"July 21st, 2025","claude-3-opus-20240229":"January 5th, 2026","claude-2.1":"July 21st, 2025","claude-2.0":"July 21st, 2025","claude-3-7-sonnet-latest":"February 19th, 2026","claude-3-7-sonnet-20250219":"February 19th, 2026"};st.Batches=se;class sr extends tN{retrieve(e,t={},s){let{betas:r}=t??{};return this._client.get(tL`/v1/models/${e}`,{...s,headers:tq([{...r?.toString()!=null?{"anthropic-beta":r?.toString()}:void 0},s?.headers])})}list(e={},t){let{betas:s,...r}=e??{};return this._client.getAPIList("/v1/models",tb,{query:r,...t,headers:tq([{...s?.toString()!=null?{"anthropic-beta":s?.toString()}:void 0},t?.headers])})}}let sn=e=>void 0!==globalThis.process?globalThis.process.env?.[e]?.trim()??void 0:void 0!==globalThis.Deno?globalThis.Deno.env?.get?.(e)?.trim():void 0;class sa{constructor({baseURL:e=sn("ANTHROPIC_BASE_URL"),apiKey:t=sn("ANTHROPIC_API_KEY")??null,authToken:s=sn("ANTHROPIC_AUTH_TOKEN")??null,...r}={}){ec.add(this),eh.set(this,void 0);const n={apiKey:t,authToken:s,...r,baseURL:e||"https://api.anthropic.com"};n.dangerouslyAllowBrowser,this.baseURL=n.baseURL,this.timeout=n.timeout??eu.DEFAULT_TIMEOUT,this.logger=n.logger??console;const a="warn";this.logLevel=a,this.logLevel=tr(n.logLevel,"ClientOptions.logLevel",this)??tr(sn("ANTHROPIC_LOG"),"process.env['ANTHROPIC_LOG']",this)??a,this.fetchOptions=n.fetchOptions,this.maxRetries=n.maxRetries??2,this.fetch=n.fetch??function(){if("undefined"!=typeof fetch)return fetch;throw Error("`fetch` is not defined as a global; Either pass `fetch` to the client, `new Anthropic({ fetch })` or polyfill the global, `globalThis.fetch = fetch`")}(),eO(this,eh,e8,"f"),this._options=n,this.apiKey=t,this.authToken=s}withOptions(e){return new this.constructor({...this._options,baseURL:this.baseURL,maxRetries:this.maxRetries,timeout:this.timeout,logger:this.logger,logLevel:this.logLevel,fetch:this.fetch,fetchOptions:this.fetchOptions,apiKey:this.apiKey,authToken:this.authToken,...e})}defaultQuery(){return this._options.defaultQuery}validateHeaders({values:e,nulls:t}){if(!(this.apiKey&&e.get("x-api-key")||t.has("x-api-key")||this.authToken&&e.get("authorization"))&&!t.has("authorization"))throw Error('Could not resolve authentication method. Expected either apiKey or authToken to be set. Or for one of the "X-Api-Key" or "Authorization" headers to be explicitly omitted')}async authHeaders(e){return tq([await this.apiKeyAuth(e),await this.bearerAuth(e)])}async apiKeyAuth(e){if(null!=this.apiKey)return tq([{"X-Api-Key":this.apiKey}])}async bearerAuth(e){if(null!=this.authToken)return tq([{Authorization:`Bearer ${this.authToken}`}])}stringifyQuery(e){return Object.entries(e).filter(([e,t])=>void 0!==t).map(([e,t])=>{if("string"==typeof t||"number"==typeof t||"boolean"==typeof t)return`${encodeURIComponent(e)}=${encodeURIComponent(t)}`;if(null===t)return`${encodeURIComponent(e)}=`;throw new eC(`Cannot stringify type ${typeof t}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}getUserAgent(){return`${this.constructor.name}/JS ${e1}`}defaultIdempotencyKey(){return`stainless-node-retry-${eN()}`}makeStatusError(e,t,s,r){return eU.generate(e,t,s,r)}buildURL(e,t,s){let r=!eI(this,ec,"m",ed).call(this)&&s||this.baseURL,n=new URL(eG.test(e)?e:r+(r.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),a=this.defaultQuery();return!function(e){if(!e)return!0;for(let t in e)return!1;return!0}(a)&&(t={...a,...t}),"object"==typeof t&&t&&!Array.isArray(t)&&(n.search=this.stringifyQuery(t)),n.toString()}_calculateNonstreamingTimeout(e){if(3600*e/128e3>600)throw new eC("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#streaming-responses for more details");return 6e5}async prepareOptions(e){}async prepareRequest(e,{url:t,options:s}){}get(e,t){return this.methodRequest("get",e,t)}post(e,t){return this.methodRequest("post",e,t)}patch(e,t){return this.methodRequest("patch",e,t)}put(e,t){return this.methodRequest("put",e,t)}delete(e,t){return this.methodRequest("delete",e,t)}methodRequest(e,t,s){return this.request(Promise.resolve(s).then(s=>({method:e,path:t,...s})))}request(e,t=null){return new tg(this,this.makeRequest(e,t,void 0))}async makeRequest(e,t,s){let r=await e,n=r.maxRetries??this.maxRetries;null==t&&(t=n),await this.prepareOptions(r);let{req:a,url:i,timeout:o}=await this.buildRequest(r,{retryCount:n-t});await this.prepareRequest(a,{url:i,options:r});let l="log_"+(0x1000000*Math.random()|0).toString(16).padStart(6,"0"),c=void 0===s?"":`, retryOf: ${s}`,u=Date.now();if(tl(this).debug(`[${l}] sending request`,tc({retryOfRequestLogID:s,method:r.method,url:i,options:r,headers:a.headers})),r.signal?.aborted)throw new eL;let h=new AbortController,d=await this.fetchWithTimeout(i,a,o,h).catch(eq),p=Date.now();if(d instanceof globalThis.Error){let e=`retrying, ${t} attempts remaining`;if(r.signal?.aborted)throw new eL;let n=ej(d)||/timed? ?out/i.test(String(d)+("cause"in d?String(d.cause):""));if(t)return tl(this).info(`[${l}] connection ${n?"timed out":"failed"} - ${e}`),tl(this).debug(`[${l}] connection ${n?"timed out":"failed"} (${e})`,tc({retryOfRequestLogID:s,url:i,durationMs:p-u,message:d.message})),this.retryRequest(r,t,s??l);if(tl(this).info(`[${l}] connection ${n?"timed out":"failed"} - error; no more retries left`),tl(this).debug(`[${l}] connection ${n?"timed out":"failed"} (error; no more retries left)`,tc({retryOfRequestLogID:s,url:i,durationMs:p-u,message:d.message})),n)throw new eH;throw new eW({cause:d})}let f=[...d.headers.entries()].filter(([e])=>"request-id"===e).map(([e,t])=>", "+e+": "+JSON.stringify(t)).join(""),m=`[${l}${c}${f}] ${a.method} ${i} ${d.ok?"succeeded":"failed"} with status ${d.status} in ${p-u}ms`;if(!d.ok){let e=await this.shouldRetry(d);if(t&&e){let e=`retrying, ${t} attempts remaining`;return await e3(d.body),tl(this).info(`${m} - ${e}`),tl(this).debug(`[${l}] response error (${e})`,tc({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,durationMs:p-u})),this.retryRequest(r,t,s??l,d.headers)}let n=e?"error; no more retries left":"error; not retryable";tl(this).info(`${m} - ${n}`);let a=await d.text().catch(e=>eq(e).message),i=e0(a),o=i?void 0:a;throw tl(this).debug(`[${l}] response error (${n})`,tc({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,message:o,durationMs:Date.now()-u})),this.makeStatusError(d.status,i,o,d.headers)}return tl(this).info(m),tl(this).debug(`[${l}] response start`,tc({retryOfRequestLogID:s,url:d.url,status:d.status,headers:d.headers,durationMs:p-u})),{response:d,options:r,controller:h,requestLogID:l,retryOfRequestLogID:s,startTime:u}}getAPIList(e,t,s){return this.requestAPIList(t,{method:"get",path:e,...s})}requestAPIList(e,t){return new tw(this,this.makeRequest(t,null,void 0),e)}async fetchWithTimeout(e,t,s,r){let{signal:n,method:a,...i}=t||{};n&&n.addEventListener("abort",()=>r.abort());let o=setTimeout(()=>r.abort(),s),l=globalThis.ReadableStream&&i.body instanceof globalThis.ReadableStream||"object"==typeof i.body&&null!==i.body&&Symbol.asyncIterator in i.body,c={signal:r.signal,...l?{duplex:"half"}:{},method:"GET",...i};a&&(c.method=a.toUpperCase());try{return await this.fetch.call(void 0,e,c)}finally{clearTimeout(o)}}async shouldRetry(e){let t=e.headers.get("x-should-retry");return"true"===t||"false"!==t&&(408===e.status||409===e.status||429===e.status||!!(e.status>=500))}async retryRequest(e,t,s,r){let n,a,i=r?.get("retry-after-ms");if(i){let e=parseFloat(i);Number.isNaN(e)||(n=e)}let o=r?.get("retry-after");if(o&&!n){let e=parseFloat(o);n=Number.isNaN(e)?Date.parse(o)-Date.now():1e3*e}if(!(n&&0<=n&&n<6e4)){let s=e.maxRetries??this.maxRetries;n=this.calculateDefaultRetryTimeoutMillis(t,s)}return await (a=n,new Promise(e=>setTimeout(e,a))),this.makeRequest(e,t-1,s)}calculateDefaultRetryTimeoutMillis(e,t){return Math.min(.5*Math.pow(2,t-e),8)*(1-.25*Math.random())*1e3}calculateNonstreamingTimeout(e,t){if(36e5*e/128e3>6e5||null!=t&&e>t)throw new eC("Streaming is required for operations that may take longer than 10 minutes. See https://github.com/anthropics/anthropic-sdk-typescript#long-requests for more details");return 6e5}async buildRequest(e,{retryCount:t=0}={}){let s={...e},{method:r,path:n,query:a,defaultBaseURL:i}=s,o=this.buildURL(n,a,i);"timeout"in s&&((e,t)=>{if("number"!=typeof t||!Number.isInteger(t))throw new eC(`${e} must be an integer`);if(t<0)throw new eC(`${e} must be a positive integer`)})("timeout",s.timeout),s.timeout=s.timeout??this.timeout;let{bodyHeaders:l,body:c}=this.buildBody({options:s}),u=await this.buildHeaders({options:e,method:r,bodyHeaders:l,retryCount:t});return{req:{method:r,headers:u,...s.signal&&{signal:s.signal},...globalThis.ReadableStream&&c instanceof globalThis.ReadableStream&&{duplex:"half"},...c&&{body:c},...this.fetchOptions??{},...s.fetchOptions??{}},url:o,timeout:s.timeout}}async buildHeaders({options:e,method:s,bodyHeaders:r,retryCount:n}){let a={};this.idempotencyHeader&&"get"!==s&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);let i=tq([a,{Accept:"application/json","User-Agent":this.getUserAgent(),"X-Stainless-Retry-Count":String(n),...e.timeout?{"X-Stainless-Timeout":String(Math.trunc(e.timeout/1e3))}:{},...t??(t=(()=>{let e="undefined"!=typeof Deno&&null!=Deno.build?"deno":"undefined"!=typeof EdgeRuntime?"edge":"[object process]"===Object.prototype.toString.call(void 0!==globalThis.process?globalThis.process:0)?"node":"unknown";if("deno"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":e4(Deno.build.os),"X-Stainless-Arch":e2(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":"string"==typeof Deno.version?Deno.version:Deno.version?.deno??"unknown"};if("undefined"!=typeof EdgeRuntime)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":globalThis.process.version};if("node"===e)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":e4(globalThis.process.platform??"unknown"),"X-Stainless-Arch":e2(globalThis.process.arch??"unknown"),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":globalThis.process.version??"unknown"};let t=function(){if("undefined"==typeof navigator||!navigator)return null;for(let{key:e,pattern:t}of[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}]){let s=t.exec(navigator.userAgent);if(s){let t=s[1]||0,r=s[2]||0,n=s[3]||0;return{browser:e,version:`${t}.${r}.${n}`}}}return null}();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":e1,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}})()),...this._options.dangerouslyAllowBrowser?{"anthropic-dangerous-direct-browser-access":"true"}:void 0,"anthropic-version":"2023-06-01"},await this.authHeaders(e),this._options.defaultHeaders,r,e.headers]);return this.validateHeaders(i),i.values}buildBody({options:{body:e,headers:t}}){if(!e)return{bodyHeaders:void 0,body:void 0};let s=tq([t]);return ArrayBuffer.isView(e)||e instanceof ArrayBuffer||e instanceof DataView||"string"==typeof e&&s.values.has("content-type")||globalThis.Blob&&e instanceof globalThis.Blob||e instanceof FormData||e instanceof URLSearchParams||globalThis.ReadableStream&&e instanceof globalThis.ReadableStream?{bodyHeaders:void 0,body:e}:"object"==typeof e&&(Symbol.asyncIterator in e||Symbol.iterator in e&&"next"in e&&"function"==typeof e.next)?{bodyHeaders:void 0,body:e6(e)}:eI(this,eh,"f").call(this,{body:e,headers:s})}}eu=sa,eh=new WeakMap,ec=new WeakSet,ed=function(){return"https://api.anthropic.com"!==this.baseURL},sa.Anthropic=eu,sa.HUMAN_PROMPT="\\n\\nHuman:",sa.AI_PROMPT="\\n\\nAssistant:",sa.DEFAULT_TIMEOUT=6e5,sa.AnthropicError=eC,sa.APIError=eU,sa.APIConnectionError=eW,sa.APIConnectionTimeoutError=eH,sa.APIUserAbortError=eL,sa.NotFoundError=eB,sa.ConflictError=eK,sa.RateLimitError=eV,sa.BadRequestError=eD,sa.AuthenticationError=eF,sa.InternalServerError=ez,sa.PermissionDeniedError=eX,sa.UnprocessableEntityError=eJ,sa.toFile=tO;class si extends sa{constructor(){super(...arguments),this.completions=new t6(this),this.messages=new st(this),this.models=new sr(this),this.beta=new t5(this)}}si.Completions=t6,si.Messages=st,si.Models=sr,si.Beta=t5;let so=new si({apiKey:process.env.ANTHROPIC_API_KEY});async function sl(e){let t=Date.now();try{var s,r;let n,a=(r=(s=e,(n=[]).push(`Call Duration: ${Math.floor(s.durationSeconds/60)}m ${Math.floor(s.durationSeconds%60)}s`),n.push(`Language: ${s.language||"Unknown"}`),n.push(""),n.push("TRANSCRIPT:"),n.push("---"),n.push(""),s.turns.forEach(e=>{var t;let s,r,a=(t=e.timestamp,s=Math.floor(t/60),r=Math.floor(t%60),`${s.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`),i="agent"===e.speaker?"AGENT":"CUSTOMER";n.push(`[${a}] ${i}: ${e.text}`)}),n.join("\n")),`You are an expert Quality Assurance analyst for customer service and sales calls. Analyze the following call transcript and provide a comprehensive QA evaluation.

${r}

Please analyze this call across the following 8 dimensions, scoring each from 0-10:

1. **Rapport Building** (rapport): How well did the agent establish connection and trust with the customer?
   - 8-10: Excellent rapport, warm and personable, builds strong connection
   - 5-7: Adequate rapport, professional but somewhat distant
   - 0-4: Poor rapport, cold or impersonal interaction

2. **Needs Discovery** (needsDiscovery): How effectively did the agent identify customer needs and pain points?
   - 8-10: Thorough discovery, asked probing questions, uncovered key needs
   - 5-7: Basic discovery, identified some needs but missed opportunities
   - 0-4: Poor discovery, failed to understand customer needs

3. **Product Knowledge** (productKnowledge): How well did the agent demonstrate understanding of products/services?
   - 8-10: Expert knowledge, confident explanations, handled complex questions
   - 5-7: Adequate knowledge, answered most questions correctly
   - 0-4: Poor knowledge, gave incorrect or incomplete information

4. **Objection Handling** (objectionHandling): How effectively did the agent address concerns and objections?
   - 8-10: Excellent handling, addressed concerns thoroughly, turned objections into opportunities
   - 5-7: Adequate handling, addressed concerns but lacked confidence
   - 0-4: Poor handling, avoided or dismissed objections

5. **Closing Techniques** (closing): How well did the agent move toward a resolution or next step?
   - 8-10: Strong close, clear next steps, gained commitment
   - 5-7: Adequate close, some next steps but lacked clarity
   - 0-4: Weak or no close, left customer uncertain

6. **Compliance** (compliance): Did the agent follow required scripts, disclosures, and legal requirements?
   - 8-10: Full compliance, all required elements covered
   - 5-7: Mostly compliant, minor omissions
   - 0-4: Non-compliant, missed critical requirements

7. **Professionalism** (professionalism): How professional was the agent's communication and demeanor?
   - 8-10: Highly professional, polished communication, appropriate tone
   - 5-7: Adequately professional, occasional lapses
   - 0-4: Unprofessional behavior or communication

8. **Follow-Up** (followUp): How well did the agent set expectations for next steps and follow-up?
   - 8-10: Clear follow-up plan, documented action items, set expectations
   - 5-7: Basic follow-up, some next steps mentioned
   - 0-4: No follow-up plan or unclear next steps

Additionally, identify:
- **Key Moments**: 3-5 specific moments (positive, negative, or neutral) with exact quotes and timestamps
- **Call Outcome**: Brief description of how the call ended (e.g., "Sale closed", "Follow-up scheduled", "Customer declined")
- **Coaching Recommendations**: 3-5 specific, actionable coaching points for the agent
- **Compliance Issues**: Any compliance violations or concerns (empty array if none)
- **Summary**: 2-3 sentence overall summary of the call

Respond in the following JSON format (and ONLY JSON, no markdown formatting):

{
  "overallScore": 7.5,
  "scores": {
    "rapport": 8,
    "needsDiscovery": 7,
    "productKnowledge": 9,
    "objectionHandling": 6,
    "closing": 7,
    "compliance": 9,
    "professionalism": 8,
    "followUp": 7
  },
  "keyMoments": [
    {
      "timestamp": 45,
      "type": "positive",
      "category": "rapport",
      "description": "Agent showed empathy for customer's situation",
      "quote": "I completely understand how frustrating that must be for you"
    }
  ],
  "coachingRecommendations": [
    "Practice more probing questions during needs discovery phase",
    "Work on confidence when handling price objections"
  ],
  "summary": "Agent successfully closed the sale with strong product knowledge. Could improve objection handling and needs discovery.",
  "callOutcome": "Sale closed - customer purchased premium package",
  "complianceIssues": []
}`),i=await so.messages.create({model:"claude-sonnet-4-5-20250929",max_tokens:4096,temperature:.3,messages:[{role:"user",content:a}]}),o="text"===i.content[0].type?i.content[0].text:"",l=function(e){try{let t=e.trim();t.startsWith("```json")?t=t.replace(/^```json\n?/,"").replace(/\n?```$/,""):t.startsWith("```")&&(t=t.replace(/^```\n?/,"").replace(/\n?```$/,""));let s=JSON.parse(t);return{overallScore:s.overallScore||0,scores:{rapport:s.scores?.rapport||0,needsDiscovery:s.scores?.needsDiscovery||0,productKnowledge:s.scores?.productKnowledge||0,objectionHandling:s.scores?.objectionHandling||0,closing:s.scores?.closing||0,compliance:s.scores?.compliance||0,professionalism:s.scores?.professionalism||0,followUp:s.scores?.followUp||0},keyMoments:s.keyMoments||[],coachingRecommendations:s.coachingRecommendations||[],summary:s.summary||"No summary provided",callOutcome:s.callOutcome||"Unknown outcome",complianceIssues:s.complianceIssues||[]}}catch(t){throw console.error("Failed to parse Claude response:",t),console.error("Raw response:",e),Error("Failed to parse analysis response from Claude")}}(o),c=Date.now()-t;return{callId:e.callId,overallScore:l.overallScore,scores:l.scores,keyMoments:l.keyMoments,coachingRecommendations:l.coachingRecommendations,summary:l.summary,callOutcome:l.callOutcome,complianceIssues:l.complianceIssues,processingTime:c}}catch(e){throw console.error("Claude analysis error:",e),Error(`Failed to analyze transcript: ${e.message}`)}}var sc=e.i(83084);async function su(e){try{let t,s;if(!process.env.ANTHROPIC_API_KEY)return e$.NextResponse.json({error:"ANTHROPIC_API_KEY not configured"},{status:500});let r=await e.json();if(r.callId){let e=await (0,sc.getTranscript)(r.callId);if(!e)return e$.NextResponse.json({error:"Transcript not found for this call"},{status:404});t=e}else{if(!r.transcript)return e$.NextResponse.json({error:"Either callId or transcript is required"},{status:400});t=r.transcript}if(!t||!t.callId||!Array.isArray(t.turns))return e$.NextResponse.json({error:"Invalid transcript format"},{status:400});if(0===t.turns.length)return e$.NextResponse.json({error:"Transcript is empty"},{status:400});let n=(s=t.turns.reduce((e,t)=>e+t.text.split(" ").length,0),Math.ceil(1.5*(s+800))/1e6*3+.015);console.log(`Analyzing transcript ${t.callId} (estimated cost: $${n.toFixed(4)})`);let a=await sl(t);return await (0,sc.saveAnalysis)(a),await (0,sc.updateCall)(t.callId,{status:"complete",overallScore:a.overallScore,analysisUrl:`/data/analyses/${t.callId}.json`}),e$.NextResponse.json({analysis:a,estimatedCost:n},{status:200})}catch(t){console.error("Analysis API error:",t);try{let s=await e.json(),r=s.callId||s.transcript?.callId;r&&await (0,sc.updateCall)(r,{status:"error",errorMessage:t.message})}catch{}return e$.NextResponse.json({error:"Failed to analyze transcript",details:t.message},{status:500})}}async function sh(){let e=!!process.env.ANTHROPIC_API_KEY;return e$.NextResponse.json({status:"ok",service:"Claude QA Analysis API",model:"claude-sonnet-4.5-20250929",configured:e})}e.s(["GET",()=>sh,"POST",()=>su],61312);var sd=e.i(61312);let sp=new ep.AppRouteRouteModule({definition:{kind:ef.RouteKind.APP_ROUTE,page:"/api/analyze/route",pathname:"/api/analyze",filename:"route",bundlePath:""},distDir:".next",relativeProjectDir:"",resolvedPagePath:"[project]/src/app/api/analyze/route.ts",nextConfigOutput:"",userland:sd}),{workAsyncStorage:sf,workUnitAsyncStorage:sm,serverHooks:sg}=sp;function sy(){return(0,em.patchFetch)({workAsyncStorage:sf,workUnitAsyncStorage:sm})}async function sw(e,t,s){sp.isDev&&(0,eg.addRequestMeta)(e,"devRequestTimingInternalsEnd",process.hrtime.bigint());let r="/api/analyze/route";r=r.replace(/\/index$/,"")||"/";let n=await sp.prepare(e,t,{srcPage:r,multiZoneDraftMode:!1});if(!n)return t.statusCode=400,t.end("Bad Request"),null==s.waitUntil||s.waitUntil.call(s,Promise.resolve()),null;let{buildId:a,params:i,nextConfig:o,parsedUrl:l,isDraftMode:c,prerenderManifest:u,routerServerContext:h,isOnDemandRevalidate:d,revalidateOnlyGenerated:p,resolvedPathname:f,clientReferenceManifest:m,serverActionsManifest:g}=n,y=(0,ev.normalizeAppPath)(r),w=!!(u.dynamicRoutes[y]||u.routes[f]),b=async()=>((null==h?void 0:h.render404)?await h.render404(e,t,l,!1):t.end("This page could not be found"),null);if(w&&!c){let e=!!u.routes[f],t=u.dynamicRoutes[y];if(t&&!1===t.fallback&&!e){if(o.experimental.adapterPath)return await b();throw new eE.NoFallbackError}}let v=null;!w||sp.isDev||c||(v="/index"===(v=f)?"/":v);let _=!0===sp.isDev||!w,k=w&&!_;g&&m&&(0,ew.setReferenceManifestsSingleton)({page:r,clientReferenceManifest:m,serverActionsManifest:g,serverModuleMap:(0,eb.createServerModuleMap)({serverActionsManifest:g})});let S=e.method||"GET",x=(0,ey.getTracer)(),R=x.getActiveScopeSpan(),M={params:i,prerenderManifest:u,renderOpts:{experimental:{authInterrupts:!!o.experimental.authInterrupts},cacheComponents:!!o.cacheComponents,supportsDynamicResponse:_,incrementalCache:(0,eg.getRequestMeta)(e,"incrementalCache"),cacheLifeProfiles:o.cacheLife,waitUntil:s.waitUntil,onClose:e=>{t.on("close",e)},onAfterTaskError:void 0,onInstrumentationRequestError:(t,s,r)=>sp.onRequestError(e,t,r,h)},sharedContext:{buildId:a}},A=new e_.NodeNextRequest(e),P=new e_.NodeNextResponse(t),E=ek.NextRequestAdapter.fromNodeNextRequest(A,(0,ek.signalFromNodeResponse)(t));try{let n=async e=>sp.handle(E,M).finally(()=>{if(!e)return;e.setAttributes({"http.status_code":t.statusCode,"next.rsc":!1});let s=x.getRootSpanAttributes();if(!s)return;if(s.get("next.span_type")!==eS.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${s.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let n=s.get("next.route");if(n){let t=`${S} ${n}`;e.setAttributes({"next.route":n,"http.route":n,"next.span_name":t}),e.updateName(t)}else e.updateName(`${S} ${r}`)}),a=!!(0,eg.getRequestMeta)(e,"minimalMode"),i=async i=>{var l,f;let m=async({previousCacheEntry:o})=>{try{if(!a&&d&&p&&!o)return t.statusCode=404,t.setHeader("x-nextjs-cache","REVALIDATED"),t.end("This page could not be found"),null;let r=await n(i);e.fetchMetrics=M.renderOpts.fetchMetrics;let l=M.renderOpts.pendingWaitUntil;l&&s.waitUntil&&(s.waitUntil(l),l=void 0);let c=M.renderOpts.collectedTags;if(!w)return await (0,eR.sendResponse)(A,P,r,M.renderOpts.pendingWaitUntil),null;{let e=await r.blob(),t=(0,eM.toNodeOutgoingHttpHeaders)(r.headers);c&&(t[eP.NEXT_CACHE_TAGS_HEADER]=c),!t["content-type"]&&e.type&&(t["content-type"]=e.type);let s=void 0!==M.renderOpts.collectedRevalidate&&!(M.renderOpts.collectedRevalidate>=eP.INFINITE_CACHE)&&M.renderOpts.collectedRevalidate,n=void 0===M.renderOpts.collectedExpire||M.renderOpts.collectedExpire>=eP.INFINITE_CACHE?void 0:M.renderOpts.collectedExpire;return{value:{kind:eT.CachedRouteKind.APP_ROUTE,status:r.status,body:Buffer.from(await e.arrayBuffer()),headers:t},cacheControl:{revalidate:s,expire:n}}}}catch(t){throw(null==o?void 0:o.isStale)&&await sp.onRequestError(e,t,{routerKind:"App Router",routePath:r,routeType:"route",revalidateReason:(0,ex.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:d})},h),t}},g=await sp.handleResponse({req:e,nextConfig:o,cacheKey:v,routeKind:ef.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:u,isRoutePPREnabled:!1,isOnDemandRevalidate:d,revalidateOnlyGenerated:p,responseGenerator:m,waitUntil:s.waitUntil,isMinimalMode:a});if(!w)return null;if((null==g||null==(l=g.value)?void 0:l.kind)!==eT.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==g||null==(f=g.value)?void 0:f.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});a||t.setHeader("x-nextjs-cache",d?"REVALIDATED":g.isMiss?"MISS":g.isStale?"STALE":"HIT"),c&&t.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let y=(0,eM.fromNodeOutgoingHttpHeaders)(g.value.headers);return a&&w||y.delete(eP.NEXT_CACHE_TAGS_HEADER),!g.cacheControl||t.getHeader("Cache-Control")||y.get("Cache-Control")||y.set("Cache-Control",(0,eA.getCacheControlHeader)(g.cacheControl)),await (0,eR.sendResponse)(A,P,new Response(g.value.body,{headers:y,status:g.value.status||200})),null};R?await i(R):await x.withPropagatedContext(e.headers,()=>x.trace(eS.BaseServerSpan.handleRequest,{spanName:`${S} ${r}`,kind:ey.SpanKind.SERVER,attributes:{"http.method":S,"http.target":e.url}},i))}catch(t){if(t instanceof eE.NoFallbackError||await sp.onRequestError(e,t,{routerKind:"App Router",routePath:y,routeType:"route",revalidateReason:(0,ex.getRevalidateReason)({isStaticGeneration:k,isOnDemandRevalidate:d})}),w)throw t;return await (0,eR.sendResponse)(A,P,new Response(null,{status:500})),null}}e.s(["handler",()=>sw,"patchFetch",()=>sy,"routeModule",()=>sp,"serverHooks",()=>sg,"workAsyncStorage",()=>sf,"workUnitAsyncStorage",()=>sm],26794)}];

//# sourceMappingURL=node_modules_next_dist_esm_build_templates_app-route_2f6e8818.js.map