module.exports=[93695,(t,e,a)=>{e.exports=t.x("next/dist/shared/lib/no-fallback-error.external.js",()=>require("next/dist/shared/lib/no-fallback-error.external.js"))},70406,(t,e,a)=>{e.exports=t.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},18622,(t,e,a)=>{e.exports=t.x("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js",()=>require("next/dist/compiled/next-server/app-page-turbo.runtime.prod.js"))},56704,(t,e,a)=>{e.exports=t.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(t,e,a)=>{e.exports=t.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},24725,(t,e,a)=>{e.exports=t.x("next/dist/server/app-render/after-task-async-storage.external.js",()=>require("next/dist/server/app-render/after-task-async-storage.external.js"))},14747,(t,e,a)=>{e.exports=t.x("path",()=>require("path"))},24868,(t,e,a)=>{e.exports=t.x("fs/promises",()=>require("fs/promises"))},83084,t=>{"use strict";var e=t.i(24868),a=t.i(14747);let r=a.default.join(process.cwd(),"data"),l=a.default.join(r,"calls","calls.json"),n=a.default.join(r,"uploads"),i=a.default.join(r,"transcripts"),s=a.default.join(r,"analyses");async function o(){await e.default.mkdir(a.default.join(r,"calls"),{recursive:!0}),await e.default.mkdir(n,{recursive:!0}),await e.default.mkdir(i,{recursive:!0}),await e.default.mkdir(s,{recursive:!0})}async function u(){try{let t=await e.default.readFile(l,"utf-8"),a=JSON.parse(t),r=new Set,n=a.filter(t=>!r.has(t.id)&&(r.add(t.id),!0));return n.length!==a.length&&(console.log(`Removed ${a.length-n.length} duplicate call(s)`),await d(n)),n}catch(t){if("ENOENT"===t.code)return[];throw t}}async function d(t){await o(),await e.default.writeFile(l,JSON.stringify(t,null,2),"utf-8")}async function f(t){let e=await u(),a=e.findIndex(e=>e.id===t.id);return -1!==a?e[a]=t:e.push(t),await d(e),t}async function c(t){return(await u()).find(e=>e.id===t)||null}async function p(t,e){let a=await u(),r=a.findIndex(e=>e.id===t);return -1===r?null:(a[r]={...a[r],...e,updatedAt:new Date},await d(a),a[r])}async function w(t,r){await o();let l=a.default.join(n,r);return await e.default.writeFile(l,t),l}function x(t){return a.default.join(n,t)}function y(){return`call_${Date.now()}_${Math.random().toString(36).substring(2,9)}`}async function g(t){await o();let r=a.default.join(i,`${t.callId}.json`);await e.default.writeFile(r,JSON.stringify(t,null,2),"utf-8")}async function j(t,r){await o();let l=a.default.join(i,`${t}.txt`);await e.default.writeFile(l,r,"utf-8")}async function h(t){try{let r=a.default.join(i,`${t}.json`),l=await e.default.readFile(r,"utf-8");return JSON.parse(l)}catch(t){if("ENOENT"===t.code)return null;throw t}}async function m(t){await o();let r=a.default.join(s,`${t.callId}.json`);await e.default.writeFile(r,JSON.stringify(t,null,2),"utf-8")}async function v(t){try{let r=a.default.join(s,`${t}.json`),l=await e.default.readFile(r,"utf-8");return JSON.parse(l)}catch(t){if("ENOENT"===t.code)return null;throw t}}async function k(t){let[e,a,r]=await Promise.all([c(t),h(t),v(t)]);return{call:e,transcript:a,analysis:r}}async function S(t){try{let r=(await u()).filter(e=>e.id!==t);await d(r);try{await e.default.unlink(a.default.join(i,`${t}.json`))}catch{}try{await e.default.unlink(a.default.join(i,`${t}.txt`))}catch{}try{await e.default.unlink(a.default.join(s,`${t}.json`))}catch{}let l=await c(t);if(l?.filename)try{await e.default.unlink(x(l.filename))}catch{}return!0}catch(t){return console.error("Error deleting call:",t),!1}}async function C(){let t=await u(),r={totalCalls:t.length,uploadedCalls:t.filter(t=>"pending"===t.status).length,transcribedCalls:t.filter(t=>"analyzing"===t.status||"complete"===t.status).length,analyzedCalls:t.filter(t=>"complete"===t.status).length,errorCalls:t.filter(t=>"error"===t.status).length,totalStorageBytes:0};try{let t=await e.default.readdir(i),l=await e.default.readdir(s),o=await e.default.readdir(n);for(let l of t){let t=await e.default.stat(a.default.join(i,l));r.totalStorageBytes+=t.size}for(let t of l){let l=await e.default.stat(a.default.join(s,t));r.totalStorageBytes+=l.size}for(let t of o){let l=await e.default.stat(a.default.join(n,t));r.totalStorageBytes+=l.size}}catch(t){console.error("Error calculating storage size:",t)}return r}t.s(["addCall",()=>f,"deleteCall",()=>S,"generateCallId",()=>y,"getCallById",()=>c,"getCompleteCallData",()=>k,"getStorageStats",()=>C,"getTranscript",()=>h,"getUploadPath",()=>x,"readCalls",()=>u,"saveAnalysis",()=>m,"saveTranscript",()=>g,"saveTranscriptAsText",()=>j,"saveUploadedFile",()=>w,"updateCall",()=>p])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__b770037d._.js.map